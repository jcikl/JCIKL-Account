# 粘贴导入功能使用指南

## 概述

粘贴导入功能允许您从剪贴板直接粘贴数据来批量导入交易记录、项目和分类。这个功能支持多种数据格式，并提供实时数据验证和预览。

## 支持的功能模块

### 1. 银行交易记录粘贴导入
- **位置**: 银行交易页面 → 工具栏 → "粘贴导入" 按钮
- **权限要求**: 助理副主席及以上权限
- **数据格式**: CSV、TSV、Excel格式

### 2. 项目账户粘贴导入
- **位置**: 项目账户页面 → 工具栏 → "粘贴导入" 按钮
- **权限要求**: 助理副主席或财务主管权限
- **数据格式**: CSV、TSV、Excel格式

### 3. 分类管理粘贴导入
- **位置**: 分类管理页面 → 工具栏 → "粘贴导入" 按钮
- **权限要求**: 副主席及以上权限
- **数据格式**: CSV、TSV、Excel格式

## 数据格式要求

### 银行交易记录格式
```
日期,描述,描述2,支出金额,收入金额,状态,项目户口,分类
2024-01-15,办公室用品,办公用品,245.00,0.00,Pending,项目A,办公用品
2024-01-16,销售收入,产品销售,0.00,1500.00,Completed,项目B,销售收入
```

**字段说明**:
- `日期`: 交易日期 (YYYY-MM-DD格式)
- `描述`: 交易描述 (必填)
- `描述2`: 交易描述2 (可选)
- `支出金额`: 支出金额 (数字，0.00格式)
- `收入金额`: 收入金额 (数字，0.00格式)
- `状态`: 交易状态 (Completed/Pending/Draft 或 已完成/待处理/草稿)
- `项目户口`: 关联的项目名称 (可选)
- `分类`: 收支分类 (可选)

### 项目账户格式
```
项目名称,项目代码,BOD分类,预算,状态,开始日期,结束日期,描述
年度晚宴,ANNUAL_DINNER_2024,P,50000.00,Active,2024-01-01,2024-12-31,年度会员晚宴活动
培训课程,TRAINING_2024,VPI,25000.00,Active,2024-02-01,2024-11-30,会员培训课程
```

**字段说明**:
- `项目名称`: 项目名称 (必填)
- `项目代码`: 项目唯一代码 (必填)
- `BOD分类`: BOD分类 (P/HT/EVP/LS/GLC/VPI/VPB/VPIA/VPC/VPLOM)
- `预算`: 项目预算金额 (数字)
- `状态`: 项目状态 (Active/Completed/On Hold 或 活跃/已完成/暂停)
- `开始日期`: 项目开始日期 (YYYY-MM-DD格式)
- `结束日期`: 项目结束日期 (YYYY-MM-DD格式，可选)
- `描述`: 项目描述 (可选)

### 分类管理格式
```
分类代码,分类名称,分类类型,描述,是否启用
EXP001,办公用品,Expense,办公用品和文具费用,true
INC001,销售收入,Income,产品销售和服务收入,true
```

**字段说明**:
- `分类代码`: 分类唯一代码 (必填)
- `分类名称`: 分类名称 (必填)
- `分类类型`: 分类类型 (Income/Expense 或 收入/支出)
- `描述`: 分类描述 (可选)
- `是否启用`: 是否启用分类 (true/false 或 是/否)

## 使用步骤

### 1. 准备数据
1. 在Excel或其他电子表格软件中准备数据
2. 确保数据格式符合上述要求
3. 复制要导入的数据行（包含标题行）

### 2. 打开粘贴导入对话框
1. 进入相应的功能页面
2. 点击工具栏中的"粘贴导入"按钮

### 3. 配置导入选项
1. **数据格式**: 选择您的数据格式 (CSV/TSV/Excel)
2. **跳过标题行**: 如果数据包含标题行，请勾选此项
3. **更新现有记录**: 如果找到相同记录，是否更新而不是创建新记录

### 4. 粘贴数据
1. 点击"从剪贴板粘贴"按钮，或手动粘贴数据到文本框
2. 系统会自动解析数据并显示预览

### 5. 验证和导入
1. 查看解析结果，确认有效和无效记录
2. 检查数据预览，确保数据正确
3. 点击"导入"按钮完成导入

## 功能特性

### 实时数据验证
- 自动验证数据格式和必填字段
- 显示详细的错误信息
- 支持多种日期和数字格式

### 数据预览
- 显示有效记录的预览
- 显示无效记录的详细错误信息
- 区分新增和更新记录

### 批量操作
- 支持一次性导入多条记录
- 自动处理重复记录
- 提供导入统计信息

### 错误处理
- 详细的错误提示
- 部分成功导入（有效记录会被导入）
- 支持重新编辑和导入

## 注意事项

1. **权限要求**: 确保您有相应的操作权限
2. **数据备份**: 建议在导入前备份现有数据
3. **格式要求**: 严格按照数据格式要求准备数据
4. **字符编码**: 建议使用UTF-8编码
5. **数据量**: 建议单次导入不超过1000条记录

## 常见问题

### Q: 为什么粘贴按钮无法使用？
A: 请检查浏览器是否允许访问剪贴板，或手动粘贴数据到文本框中。

### Q: 数据解析失败怎么办？
A: 检查数据格式是否符合要求，特别是日期格式和必填字段。

### Q: 如何更新现有记录？
A: 勾选"更新现有记录"选项，系统会根据唯一标识符（如项目代码、分类代码）匹配现有记录。

### Q: 导入后数据没有显示？
A: 请刷新页面或检查是否有权限问题。

## 技术支持

如果遇到问题，请联系系统管理员或查看控制台错误信息。 